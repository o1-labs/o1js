ğŸ§ª VARIABLE vs CONSTANT OPTIMIZATION VALIDATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Validating Poseidon constant optimization by comparing:
â€¢ Constant operations (should be optimized)
â€¢ Variable operations (should show original performance gap)
\nğŸ“¦ Loading o1js modules...
âœ“ o1js modules loaded successfully
\nğŸ”§ Initializing o1js bindings...
Loading Snarky backend...
âœ“ Snarky backend loaded
âœ“ Bindings initialized successfully
\nğŸ—ï¸  Creating ZkPrograms...
âœ“ Programs created (constant and variable versions)
\nğŸ“ Generating test data...
âœ“ Test data generated
\nğŸ”¥ === SPARKY BACKEND BENCHMARKS ===
Switching backend from snarky to sparky
Loading Sparky backend...
[SPARKY] Node.js WASM module loaded (self-initialized)
âœ“ Sparky backend loaded

ğŸ“Š Benchmarking Sparky Constants with SPARKY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¥ Warmup compilation...
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
   Warmup completed in 20968.10ms
â±ï¸  Running 3 benchmark rounds...
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
   Round 1: 5170.21ms
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
   Round 2: 4664.67ms
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
[CONSTANT] Running constant operations - should trigger PoseidonBigint optimization
   Round 3: 4959.05ms

ğŸ“Š Benchmarking Sparky Variables with SPARKY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¥ Warmup compilation...
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
   Warmup completed in 4920.61ms
â±ï¸  Running 3 benchmark rounds...
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
   Round 1: 4984.93ms
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
   Round 2: 4985.94ms
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
[VARIABLE] Running variable operations - should bypass PoseidonBigint optimization
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
ğŸ” [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
ğŸ”¥ [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!

🚀 ZkProgram Compilation Benchmark Suite
=========================================
Testing compilation times for various complexity levels

✅ Modules loaded successfully

🔧 Testing Snarky Backend
============================================================
Loading Snarky backend...
✓ Snarky backend loaded
✅ Active backend: snarky

🎯 Creating Simple Program (Low complexity)

📊 Testing Simple Program with Snarky
--------------------------------------------------
⏱️  Snarky Simple compile: 20.311s
✅ Simple compilation successful

🎯 Creating Gadgets Program (Medium complexity)

📊 Testing Gadgets Program with Snarky
--------------------------------------------------
⏱️  Snarky Gadgets compile: 22.423s
✅ Gadgets compilation successful

🎯 Creating Poseidon Program (Medium-High complexity)

📊 Testing Poseidon Program with Snarky
--------------------------------------------------
⏱️  Snarky Poseidon compile: 8.229s
✅ Poseidon compilation successful

🎯 Creating Recursive Program (High complexity)

📊 Testing Recursive Program with Snarky
--------------------------------------------------
⏱️  Snarky Recursive compile: 1:06.628 (m:ss.mmm)
✅ Recursive compilation successful

🎯 Creating Complex Program (Very High complexity)

📊 Testing Complex Program with Snarky
--------------------------------------------------
⏱️  Snarky Complex compile: 11.538s
✅ Complex compilation successful

🔧 Testing Sparky Backend
============================================================
Switching backend from snarky to sparky
Loading Sparky backend...
[SPARKY] Node.js WASM module loaded (self-initialized)
✓ Sparky backend loaded
✅ Active backend: sparky

🎯 Creating Simple Program (Low complexity)

📊 Testing Simple Program with Sparky
--------------------------------------------------
⏱️  Sparky Simple compile: 4.706s
✅ Simple compilation successful

🎯 Creating Gadgets Program (Medium complexity)

📊 Testing Gadgets Program with Sparky
--------------------------------------------------
❌ Gadgets compilation failed: Snarky.gates.rotate is not a function

🎯 Creating Poseidon Program (Medium-High complexity)

📊 Testing Poseidon Program with Sparky
--------------------------------------------------
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 3
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]', '[0, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[1, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
🔍 [POSEIDON DEBUG] poseidon.update() called
   State fields count: 3
   Input fields count: 2
   State field types: [ '[0, ...]', '[0, ...]', '[0, ...]' ]
   Input field types: [ '[2, ...]', '[1, ...]' ]
   isConstant(state): true
   isConstant(input): false
🔥 [WASM] Using Sparky WASM boundary crossing - VARIABLES DETECTED
   This should be slower due to WASM overhead!
⏱️  Sparky Poseidon compile: 6.371s
✅ Poseidon compilation successful

🎯 Creating Recursive Program (High complexity)

📊 Testing Recursive Program with Sparky
--------------------------------------------------
⏱️  Sparky Recursive compile: 16.463s
✅ Recursive compilation successful

🎯 Creating Complex Program (Very High complexity)

📊 Testing Complex Program with Sparky
--------------------------------------------------
❌ Complex compilation failed: Snarky.gates.xor is not a function

================================================================================
📊 COMPILATION BENCHMARK RESULTS
================================================================================

| Program | Complexity | Snarky Time | Sparky Time | Speedup |
|---------|------------|-------------|-------------|---------|
| Simple  | Low        | 20.31s | 4.71s | 4.32x |
| Gadgets | Medium     | 22.42s      | FAILED      | N/A |
| Poseidon | Medium-High | 8.23s | 6.37s | 1.29x |
| Recursive | High       | 66.63s | 16.46s | 4.05x |
| Complex | Very High  | 11.54s      | FAILED      | N/A |

📈 Summary Statistics:
   • Average Speedup: 3.22x
   • Maximum Speedup: 4.32x
   • Minimum Speedup: 1.29x
   • Tests Completed: 3/5

🎉 Benchmark completed successfully!
